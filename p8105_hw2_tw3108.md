p8105_hw2_tw3108
================
Tao Wu
2025-10-01

``` r
library(tidyverse)
pols <- read_csv("data/pols-month.csv")
snp  <- read_csv("data/snp.csv")
unemp <- read_csv("data/unemployment.csv")
newpols <- pols %>%
  separate(mon, into = c("year", "month", "day"), sep = "-") %>%
  mutate(
    month = as.integer(month),
    month = month.name[month],
    president = if_else(prez_gop == 1, "gop", "dem")
  ) %>%
  select(-prez_gop, -prez_dem, -day)
newsnp <- snp %>%
 mutate(date = as.Date(date, format = "%m/%d/%y"),
    year = as.integer(format(date, "%Y")),
    month = as.integer(format(date, "%m")),
    month = month.name[month]
  ) %>%
  select(year, month, close) %>%    
  arrange(year, month)
newunemp <- unemp %>%
  pivot_longer(
    Jan:Dec,
    names_to = "month",
    values_to = "rate"
  ) %>%
  mutate(
    year  = as.integer(Year),
    month = month.name[match(month,month.abb)]
  ) %>%
  select(year, month, rate) %>%
  arrange(year,month)
newpols   <- newpols   %>% mutate(year = as.integer(year))
newsnp    <- newsnp    %>% mutate(year = as.integer(year))
newunemp  <- newunemp  %>% mutate(year = as.integer(year))
merged <- newpols %>%
  left_join(newsnp, by = c("year", "month"))
final <- merged %>%
  left_join(newunemp, by = c("year", "month"))
```

For this question,we can get each datasets’ information on the data
description page.pols-month ontains 822 observations of 9 variables
related to the number of national politicians who are democratic or
republican at any given time.snp contains 787 observations of 2
variables related to Standard & Poor’s stock market index (S&P). The
file “unemployment” contains 68 observations of 13 variables about the
unemployment rate in US. After cleaning and merging, the resulting
dataset final include 822 observations, covering the time period from
1947 to 2015. Key variables include `year`, `month`, `president` ,
`close` , and `rate`.

``` r
library(readxl)
library(dplyr)
data <- "data/202409 Trash Wheel Collection Data.xlsx"

mrtrash <- read_excel(
  data,
  sheet = "Mr. Trash Wheel",
  skip  = 1,
  range = readxl::cell_cols("A:M")
) %>%
  filter(!is.na(Dumpster)) %>%
  rename(
    weight_tons         = `Weight (tons)`,
    volume_cubic_yards  = `Volume (cubic yards)`,
    plastic_bottles     = `Plastic Bottles`,
    polystyrene         = Polystyrene,
    cigarette_butts     = `Cigarette Butts`,
    glass_bottles       = `Glass Bottles`,
    plastic_bags        = `Plastic Bags`,
    wrappers            = Wrappers,
    sports_balls        = `Sports Balls`
  ) %>%
  mutate(
    Year           = as.integer(Year),
    Month          = as.character(Month),
    Date           = as.Date(Date),
    weight_tons    = as.numeric(weight_tons),
    cigarette_butts= as.numeric(cigarette_butts),
    sports_balls   = as.integer(round(as.numeric(sports_balls))),
    member         = "Mr.Trash Wheel"
  )

proftrash <- read_excel(
  data,
  sheet = "Professor Trash Wheel",
  skip  = 1,
  range = readxl::cell_cols("A:M")
) %>%
  filter(!is.na(Dumpster)) %>%
  rename(
    weight_tons         = `Weight (tons)`,
    volume_cubic_yards  = `Volume (cubic yards)`,
    plastic_bottles     = `Plastic Bottles`,
    polystyrene         = Polystyrene,
    cigarette_butts     = `Cigarette Butts`,
    glass_bottles       = `Glass Bottles`,
    plastic_bags        = `Plastic Bags`,
    wrappers            = Wrappers
  ) %>%
  mutate(
    Year           = as.integer(Year),
    Month          = as.character(Month),
    Date           = as.Date(Date),
    weight_tons    = as.numeric(weight_tons),
    cigarette_butts= as.numeric(cigarette_butts),
    sports_balls   = NA_integer_, 
    member         = "Professor Trash Wheel"
  )

gwynnda <- read_excel(
  data,
  sheet = "Gwynnda Trash Wheel",
  skip  = 1,
  range = readxl::cell_cols("A:L")
) %>%
  filter(!is.na(Dumpster)) %>%
  rename(
    weight_tons         = `Weight (tons)`,
    volume_cubic_yards  = `Volume (cubic yards)`,
    plastic_bottles     = `Plastic Bottles`,
    polystyrene         = Polystyrene,
    cigarette_butts     = `Cigarette Butts`,
    plastic_bags        = `Plastic Bags`,
    wrappers            = Wrappers
  ) %>%
  mutate(
    Year           = as.integer(Year),
    Month          = tolower(as.character(Month)),
    Date           = as.Date(Date),
    weight_tons    = as.numeric(weight_tons),
    cigarette_butts= as.numeric(cigarette_butts),
    sports_balls   = NA_integer_,   
    member         = "Gwynnda"
  )

trashwheel <- bind_rows(mrtrash, proftrash, gwynnda)
totalweight <- sum(trashwheel$weight_tons[trashwheel$member == "Professor Trash Wheel"])
cigs <- sum(trashwheel$cigarette_butts[
  trashwheel$member == "Gwynnda" & format(trashwheel$Date, "%Y-%m") == "2022-06"
])
```

The Trash Wheel dataset combines information from the `Mr. Trash Wheel`,
`Professor Trash Wheel`, and `Gwynnda` in Baltimore. Each observation
corresponds to a dumpster of trash, and key variables include the date
of collection, the amount of trash collected, and counts of specific
types of litter, such as cigarette butts, and sports balls. The combined
dataset `trashwheel` contains 1033 observations. As given by data,
`Professor Trash Wheel` collected a total of NA tons of trash over the
available time period. In June 2022, Gwynnda collected 1.812^{4}
cigarettes in the water.

``` r
library(tidyverse)
zori <- readr::read_csv("data/Zip_zori_uc_sfrcondomfr_sm_month_NYC.csv")
newzori <- zori %>%
  rename(zip = RegionName) %>%
  pivot_longer(
    cols = -(1:9),
    names_to  = "date",
    values_to = "zori"
  ) %>%
  tidyr::separate(
    date, into = c("year","month","day"),
    sep = "-", convert = TRUE
  ) %>%
  mutate(
    date = as.Date(year, month, day),
  ) %>%
  select(zip, date, year, month, zori) %>%
  arrange(zip, date)
zip <- read_csv("data/Zip Codes.csv") %>%
  rename(zip = ZipCode, county= County,neighborhood = Neighborhood
  )
tidy <- newzori %>%
  left_join(zip, by = "zip") %>%
  relocate(zip, county, neighborhood, date, year, month, zori) %>%
  arrange(zip, date)
 obs <- nrow(tidy)
 zipnum <- n_distinct(tidy$zip)
 neibor <- n_distinct(tidy$neighborhood)
 range <- range(tidy$date)
ziponly <- zip %>%
  filter(!(zip %in% newzori$zip))
head(ziponly, 10)
```

    ## # A tibble: 10 × 7
    ##    county `State FIPS` `County Code` `County FIPS`   zip `File Date`
    ##    <chr>         <dbl> <chr>                 <dbl> <dbl> <chr>      
    ##  1 Bronx            36 005                   36005 10464 7/25/07    
    ##  2 Bronx            36 005                   36005 10474 7/25/07    
    ##  3 Bronx            36 005                   36005 10475 7/25/07    
    ##  4 Bronx            36 005                   36005 10499 7/25/07    
    ##  5 Bronx            36 005                   36005 10550 7/25/07    
    ##  6 Bronx            36 005                   36005 10704 7/25/07    
    ##  7 Bronx            36 005                   36005 10705 7/25/07    
    ##  8 Bronx            36 005                   36005 10803 7/25/07    
    ##  9 Kings            36 047                   36047 11202 7/25/07    
    ## 10 Kings            36 047                   36047 11224 7/25/07    
    ## # ℹ 1 more variable: neighborhood <chr>

``` r
nrow(ziponly)
```

    ## [1] 171

``` r
zori2020 <- tidy %>%
  filter(year == 2020, month == 1) %>%
  select(zip, zori2020 = zori)
zori2021 <- tidy %>%
  filter(year == 2021, month == 1) %>%
  select(zip, zori2021 = zori)
diff <- zori2020 %>%
  inner_join(zori2021, by = "zip") %>%
  mutate(diff = zori2021 - zori2020) %>%
  left_join(distinct(tidy, zip, county, neighborhood), by = "zip") %>%
  arrange(diff) %>%
 head(n = 10)
knitr::kable(
  diff %>%
    select(zip, county, neighborhood, zori2020, zori2021, diff),
)
```

|   zip | county   | neighborhood                  | zori2020 | zori2021 |      diff |
|------:|:---------|:------------------------------|---------:|---------:|----------:|
| 10007 | New York | Lower Manhattan               | 6334.211 | 5421.614 | -912.5966 |
| 10069 | New York | NA                            | 4623.042 | 3874.918 | -748.1245 |
| 10009 | New York | Lower East Side               | 3406.442 | 2692.187 | -714.2550 |
| 10016 | New York | Gramercy Park and Murray Hill | 3731.135 | 3019.431 | -711.7045 |
| 10001 | New York | Chelsea and Clinton           | 4108.098 | 3397.648 | -710.4499 |
| 10002 | New York | Lower East Side               | 3645.416 | 2935.113 | -710.3028 |
| 10004 | New York | Lower Manhattan               | 3149.658 | 2443.697 | -705.9608 |
| 10038 | New York | Lower Manhattan               | 3573.201 | 2875.616 | -697.5853 |
| 10012 | New York | Greenwich Village and Soho    | 3628.566 | 2942.344 | -686.2218 |
| 10010 | New York | Gramercy Park and Murray Hill | 3697.284 | 3012.353 | -684.9304 |
